{"version":3,"sources":["app.js"],"names":["paso","pasoInicial","pasoFinal","cita","nombre","fecha","hora","servicios","iniciarApp","mostrarSeccion","tabs","botonesPaginador","paginaSiguiente","paginaAnterior","consultarAPI","nombreCliente","seleccionarFecha","seleccionarHora","mostrarResumen","seccionAnterior","document","querySelector","classList","remove","pasoSelector","add","tabAnterior","querySelectorAll","forEach","boton","addEventListener","e","parseInt","target","dataset","async","url","resultado","fetch","mostrarServicios","json","error","console","log","servicio","id","precio","nombreServicio","createElement","textContent","precioServicio","servicioDiv","idServicio","onclick","seleccionarServicio","appendChild","divServicio","some","agregado","filter","value","dia","Date","getUTCDay","includes","mostrarAlerta","split","mensaje","tipo","elemento","desaparece","alertaPrevia","alerta","setTimeout","resumen","firstChild","removeChild","Object","values","length","headingServicios","contenedorServicio","textoServicio","innerHTML","headingCita","fechaObj","mes","getMonth","getDate","year","getFullYear","fechaFormateada","UTC","toLocaleDateString","weekday","month","day","fechaCita","horaCita","botonReservar","reservarCita","datos","map","FormData","append","respuesta","method","body"],"mappings":"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","file":"app.js","sourcesContent":["let paso = 1;\r\nconst pasoInicial = 1;\r\nconst pasoFinal = 3;\r\n\r\nconst cita = {\r\n    nombre: '',\r\n    fecha: '',\r\n    hora: '',\r\n    servicios: []\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    iniciarApp();\r\n});\r\n\r\nfunction iniciarApp() {\r\n    mostrarSeccion(); // Muestra y oculta las secciones\r\n    tabs(); // Cambia la sección cuando se presionen los tabs\r\n    botonesPaginador(); // Agrega o quita los botones del paginador\r\n    paginaSiguiente();\r\n    paginaAnterior();\r\n\r\n    consultarAPI(); // Consulta la API en el Backend de PHP\r\n\r\n    nombreCliente(); // Añade el nombre del cliente al objeto de cita\r\n    seleccionarFecha(); // Añade la fecha de la cita en el objeto\r\n    seleccionarHora(); // Añade la hora de la cita en el objeto\r\n\r\n    mostrarResumen(); // Muestra el resumen de la cita\r\n};\r\nfunction mostrarSeccion() {\r\n\r\n    // Ocultar la seccion que tenga la clase de mostrar\r\n    const seccionAnterior = document.querySelector('.mostrar');\r\n    if (seccionAnterior) {\r\n        seccionAnterior.classList.remove('mostrar');\r\n    }\r\n\r\n    // Seleccionar la seccion con el paso...\r\n    const pasoSelector = `#paso-${paso}`;\r\n    const seccion = document.querySelector(pasoSelector);\r\n    seccion.classList.add('mostrar');\r\n\r\n    // Quita la clase de actual al tab anterior\r\n    const tabAnterior = document.querySelector('.actual');\r\n    if (tabAnterior) {\r\n        tabAnterior.classList.remove('actual');\r\n    }\r\n\r\n    // Resalta el tab actual \r\n    const tab = document.querySelector(`[data-paso=\"${paso}\"]`);\r\n    tab.classList.add('actual');\r\n}\r\nfunction tabs() {\r\n    const botones = document.querySelectorAll('.tabs button');\r\n    botones.forEach( boton => {\r\n        boton.addEventListener('click', function(e) {\r\n            paso = parseInt(e.target.dataset.paso);\r\n            mostrarSeccion();\r\n            botonesPaginador();\r\n        });\r\n    });\r\n};\r\nfunction botonesPaginador() {\r\n    const paginaAnterior = document.querySelector('#anterior');\r\n    const paginaSiguiente = document.querySelector('#siguiente');\r\n\r\n    if (paso === 1) {\r\n        paginaAnterior.classList.add('ocultar');\r\n        paginaSiguiente.classList.remove('ocultar');\r\n    } else if (paso === 3) {\r\n        paginaAnterior.classList.remove('ocultar');\r\n        paginaSiguiente.classList.add('ocultar');\r\n\r\n        mostrarResumen();\r\n    } else {\r\n        paginaAnterior.classList.remove('ocultar');\r\n        paginaSiguiente.classList.remove('ocultar');\r\n    }\r\n\r\n    mostrarSeccion();\r\n};\r\nfunction paginaAnterior() {\r\n    const paginaAnterior = document.querySelector('#anterior');\r\n    paginaAnterior.addEventListener('click', function() {\r\n        \r\n        if (paso <= pasoInicial) return;\r\n        paso--;\r\n        botonesPaginador();\r\n    });\r\n};\r\nfunction paginaSiguiente() {\r\n    const paginaSiguiente = document.querySelector('#siguiente');\r\n    paginaSiguiente.addEventListener('click', function() {\r\n        \r\n        if (paso >= pasoFinal) return;\r\n        paso++;\r\n        botonesPaginador();\r\n    });\r\n};\r\nasync function consultarAPI() {\r\n    \r\n    try {\r\n        const url = 'http://localhost:3001/api/servicios';\r\n        const resultado = await fetch(url);\r\n        const servicios = await resultado.json();\r\n        mostrarServicios(servicios);\r\n    } catch (error) {\r\n        console.log(error);\r\n    }\r\n};\r\nfunction mostrarServicios(servicios) {\r\n    servicios.forEach(servicio => {\r\n        const { id, nombre, precio} = servicio;\r\n\r\n        const nombreServicio = document.createElement('P');\r\n        nombreServicio.classList.add('nombre-servicio');\r\n        nombreServicio.textContent = nombre;\r\n        \r\n        const precioServicio = document.createElement('P');\r\n        precioServicio.classList.add('precio-servicio');\r\n        precioServicio.textContent = `$${precio}`;\r\n\r\n        const servicioDiv = document.createElement('DIV');\r\n        servicioDiv.classList.add('servicio');\r\n        servicioDiv.dataset.idServicio = id;\r\n        servicioDiv.onclick = function() {\r\n            seleccionarServicio(servicio);\r\n        };\r\n\r\n        servicioDiv.appendChild(nombreServicio);\r\n        servicioDiv.appendChild(precioServicio);\r\n\r\n        document.querySelector('#servicios').appendChild(servicioDiv);\r\n    });\r\n};\r\nfunction seleccionarServicio(servicio) {\r\n    const { id } = servicio;\r\n    const { servicios } = cita;\r\n\r\n    // Identificar el elemento al que se la da click\r\n    const divServicio = document.querySelector(`[data-id-servicio=\"${id}\"]`);\r\n\r\n    // Comprobar si un servicio ya fue agregado\r\n    if ( servicios.some( agregado => agregado.id === id ) ) {\r\n        // Eliminarlo\r\n        cita.servicios = servicios.filter( agregado => agregado.id !== id );\r\n        divServicio.classList.remove('seleccionado');\r\n    } else {\r\n        // Agregarlo\r\n        cita.servicios = [...servicios, servicio];\r\n        divServicio.classList.add('seleccionado');\r\n    }\r\n};\r\nfunction nombreCliente() {\r\n    const nombre = document.querySelector('#nombre').value;\r\n    cita.nombre = nombre\r\n};\r\nfunction seleccionarFecha() {\r\n    const inputFecha = document.querySelector('#fecha');\r\n    inputFecha.addEventListener('input', function (e) {\r\n        const dia = new Date(e.target.value).getUTCDay();\r\n        \r\n        if ( [6, 0].includes(dia)) {\r\n            e.target.value = '';\r\n            mostrarAlerta('Fines de semana no permitidos', 'error', '.formulario');\r\n        } else {\r\n            cita.fecha = e.target.value;\r\n        }\r\n    });\r\n};\r\nfunction seleccionarHora() {\r\n    const inputHora = document.querySelector('#hora');\r\n    inputHora.addEventListener('input', function(e) {\r\n        const horaCita = e.target.value;\r\n        const hora = horaCita.split(':')[0];\r\n        if (hora < 10 || hora > 18) {\r\n            e.target.value = '';\r\n            mostrarAlerta('Hora No Válida', 'error', '.formulario');\r\n        } else {\r\n            cita.hora = e.target.value;\r\n        }\r\n    });\r\n};\r\nfunction mostrarAlerta(mensaje, tipo, elemento, desaparece = true) {\r\n    \r\n    // Previene que se genere más de una alerta\r\n    const alertaPrevia = document.querySelector('.alerta');\r\n    if (alertaPrevia) {\r\n        alertaPrevia.remove();\r\n    };\r\n\r\n    // Scripting para crear la alerta\r\n    const alerta = document.createElement('DIV');\r\n    alerta.textContent = mensaje;\r\n    alerta.classList.add('alerta');\r\n    alerta.classList.add(tipo);\r\n\r\n    const referencia = document.querySelector(elemento);\r\n    referencia.appendChild(alerta);\r\n\r\n    if (desaparece) {\r\n        // Eliminar la alerta\r\n        setTimeout(() => {\r\n            alerta.remove();\r\n        }, 3000);\r\n    }\r\n\r\n};\r\nfunction mostrarResumen() {\r\n    const resumen = document.querySelector('.contenido-resumen');\r\n\r\n    // Limpiar el contenido de resumen\r\n    while (resumen.firstChild) {\r\n        resumen.removeChild(resumen.firstChild);\r\n    }\r\n\r\n    if (Object.values(cita).includes('') || cita.servicios.length == 0 ) {\r\n        mostrarAlerta('Faltan datos de Servicios, Fecha u Horas', 'error', '.contenido-resumen', false);\r\n\r\n        return;\r\n    }\r\n\r\n    // Formater el div de resumen\r\n    const { nombre, fecha, hora, servicios } = cita;\r\n\r\n    // Heading para servicios en resumen\r\n    const headingServicios = document.createElement('H3');\r\n    headingServicios.textContent = 'Resumen de servicios';\r\n    resumen.appendChild(headingServicios);\r\n\r\n    // Iterando y mostrando los servicios\r\n    servicios.forEach(servicio => {\r\n        const { id, precio, nombre } = servicio;\r\n\r\n        const contenedorServicio = document.createElement('DIV');\r\n        contenedorServicio.classList.add('contenedor-servicio');\r\n\r\n        const textoServicio = document.createElement('P');\r\n        textoServicio.textContent = nombre;\r\n\r\n        const precioServicio = document.createElement('P');\r\n        precioServicio.innerHTML = `<span>Precio:</span> $${precio}`;\r\n\r\n        contenedorServicio.appendChild(textoServicio);\r\n        contenedorServicio.appendChild(precioServicio);\r\n\r\n        resumen.appendChild(contenedorServicio);\r\n    });\r\n\r\n    // Heading para Cita en resumen\r\n    const headingCita = document.createElement('H3');\r\n    headingCita.textContent = 'Resumen de Cita';\r\n    resumen.appendChild(headingCita);\r\n\r\n    const nombreCliente = document.createElement('P');\r\n    nombreCliente.innerHTML = `<span>Nombre:</span> ${nombre}`;\r\n    \r\n    // Formatear la fecha en español\r\n    const fechaObj = new Date(fecha);\r\n    const mes = fechaObj.getMonth();\r\n    const dia = fechaObj.getDate() + 2;\r\n    const year = fechaObj.getFullYear();\r\n\r\n    const fechaUTC = new Date(Date.UTC(year, mes, dia));\r\n\r\n    const opciones = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'};\r\n    const fechaFormateada = fechaUTC.toLocaleDateString('es-MX', opciones);\r\n\r\n    const fechaCita = document.createElement('P');\r\n    fechaCita.innerHTML = `<span>Fecha:</span> ${fechaFormateada}`;\r\n    \r\n    const horaCita = document.createElement('P');\r\n    horaCita.innerHTML = `<span>Hora:</span> ${hora} Horas`;\r\n\r\n    // Boton para crear una cita\r\n    const botonReservar = document.createElement('BUTTON');\r\n    botonReservar.classList.add('boton');\r\n    botonReservar.textContent = 'Reservar Cita';\r\n    botonReservar.onclick = reservarCita;\r\n\r\n    resumen.appendChild(nombreCliente);\r\n    resumen.appendChild(fechaCita);\r\n    resumen.appendChild(horaCita);\r\n\r\n    resumen.appendChild(botonReservar);\r\n};\r\n\r\nasync function reservarCita() {\r\n    const { nombre, fecha, hora, servicios } = cita;\r\n\r\n    const idServicios = servicios.map( servicio => servicio.id );\r\n\r\n    const datos = new FormData();\r\n    datos.append('nombre', nombre);\r\n    datos.append('fecha', fecha);\r\n    datos.append('hora', hora);\r\n    datos.append('servicios', servicios);\r\n\r\n    // console.log(...datos); // Mostrar los datos formateados\r\n    \r\n    // Petición hacia la API\r\n    const url = 'http://localhost:3001/api/citas';\r\n\r\n    const respuesta = await fetch(url, {\r\n        method: 'POST',\r\n        body: datos\r\n    });\r\n\r\n    const resultado = await respuesta.json();\r\n    console.log(resultado);\r\n\r\n\r\n};"]}